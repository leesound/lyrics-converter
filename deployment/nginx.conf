server {
    listen 80;
    # 请将下面的 your_domain_or_ip 替换为你的 VPS IP 地址或域名
    server_name your_domain_or_ip;

    # 网站文件的根目录，请确保你将 dist 文件夹的内容上传到了这里
    root /var/www/japanese-lyrics-converter;
    index index.html;

    # 1. 处理静态文件和前端路由 (SPA 支持)
    location / {
        try_files $uri $uri/ /index.html;
    }

    # 2. 反向代理 Baidu API (解决跨域问题)
    # 对应 vite.config.ts 中的 proxy 配置
    location /baidu-api/ {
        # 目标地址: 百度 AI 开放平台
        proxy_pass https://aip.baidubce.com/;
        
        # 必要的 Host 头，否则百度可能会拒绝请求
        proxy_set_header Host aip.baidubce.com;
        
        # 传递真实客户端 IP (可选，但推荐)
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        # 允许跨域 (如果需要的话，通常反向代理后浏览器认为是同源)
        # add_header Access-Control-Allow-Origin *;
    }
}
